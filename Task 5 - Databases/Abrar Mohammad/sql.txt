CREATE TABLE hospitals(
hospital_id SERIAL PRIMARY KEY NOT NULL,
hospital_name VARCHAR(150) NOT NULL,
address VARCHAR(200) NOT NULL,
founded_year INT
);

CREATE TABLE doctors(
doctor_id SERIAL PRIMARY KEY NOT NULL,
doctor_name VARCHAR(150) NOT NULL,
specialization VARCHAR(200),
hospital_id INT REFERENCES hospitals(hospital_id)
);

CREATE TABLE patients(
patient_id SERIAL PRIMARY KEY NOT NULL,
patient_name VARCHAR(200) NOT NULL,
disease VARCHAR(200) NOT NULL,
doctor_id INT REFERENCES doctors(doctor_id),
hospital_id INT REFERENCES hospitals(hospital_id)
);

CREATE TABLE appointments(
appointment_id SERIAL PRIMARY KEY NOT NULL,
appointment_date DATE NOT NULL,
patient_id INT REFERENCES patients(patient_id),
doctor_id INT REFERENCES doctors(doctor_id),
hospital_id INT REFERENCES hospitals(hospital_id)
);

INSERT INTO hospitals(hospital_name,address,founded_year) VALUES('Ozone Hospitals','Green Hills Kothapet',2013);
INSERT INTO hospitals(hospital_name,address,founded_year) VALUES('Landmark Hospital','Hyder Nagar Kukatpally',2012),('Shenoy Hospital','East Maredpally',1980),('Mark Multispeciality Hospital','Bandlaguda-jagir',2017),
('Madhava Multi Speciality Hospital','S D Road Secundrabad',1990),
('Care Hospitals','Hitech-City',1991),
('Sowmyashree MultiSpeciality Hospital','Venkatapuram',2000),
('Woodlands Hospital','Barkatpura',2019),
('Aparna Hospital','Serilingampally',2022),
('Oak Hospitals','Toli Chowki',2019),
('Kiran Hospital','Karmanghat',2017),
('Prasad Hospitals','Pragathi Nagar, Kukatpally',2022),
('Alavi Hospital','HMT Road Chintal',2016),
('Supraja Hospital','Nagole',2013),
('Apollo Spectra Hospitals','Kothaguda X Road Kondapur',2001),
('Sunbiz Hospital','Financial District,Nanakramguda',2009),
('Sunflower Multispeciality Hospital','JJ Nagar Neredmet',2005),
('Anaya Hospital','Narayanaguda',2004),
('Rainbow Childrens Hospital','Banjara Hills',1990),
('Yashoda Hospitals','Somajiguda',1970),
('Sunridge Multispeciality Hospital','Moti Nagar',2020),
('Germanten Hospitals','Attapur',2000);

SELECT * FROM hospitals LIMIT 100 OFFSET 0;

DELETE FROM hospitals WHERE hospital_id BETWEEN 23 AND 43;

SELECT * FROM hospitals LIMIT 100 OFFSET 0;

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Murali Yelchuri','General Physician',1),
('Dr.Ravikiran Abraham','Cardiologist',1),
('Dr.B Ramulu','Pediatrician',1),
('Dr.Usha Gaddam','Orthopedic surgeon',1),
('Dr.Prathima Chilkuri','Dermatologist',1);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Sudhir Chalasani','Family Medicine',2),
('Dr.E Priyatham','General Physician',2),
('Dr.Lakshmi Godavarthy','Cardiologist',2),
('Dr.Srinivas Yadavalli','Opthamology',2),
('Dr.M.Chandrakanth Rao','Gastroenterology',2);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Meka Satyanarayana','Urologist',3),
('Dr.S Ravindra Kumar','General Physician',3),
('Dr.C.Nithya','General Surgery',3),
('Dr.Mohammed Anfas','Pediatrician',3),
('Dr.Harshavardhan Singh','Neurologist',3);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Kolkunda Vijaykumar','Urologist',4),
('Dr.Shaeq Mirza','General Physician',4),
('Dr.Jagdeesh Kumar','General Surgery',4),
('Dr.Shivani Payneni','Pediatrician',4),
('Dr.Indira Ramasahayam Reddy','Neurologist',4);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Aashrita Mekala','Urologist',5),
('Dr.Sonal Jain','General Physician',5),
('Dr.S Bhattcharjee','General Surgery',5),
('Dr.Vasanth Kumar','Pediatrician',5),
('Dr.Harish Kadarala','Neurologist',5);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Anish Anand Janareddy','Urologist',6),
('Dr.Manoj Kumar','General Physician',6),
('Dr.Jaganmani Sreekanth','General Surgery',6),
('Dr.P Ramu','Pediatrician',6),
('Dr.Srinivas Jakkinaboina','Neurologist',6);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.K Sandeep Reddy','Urologist',7),
('Dr.Naveen Reddy A','General Physician',7),
('Dr.Naveen Polavarapu','General Surgery',7),
('Dr.Mithil B Ghushe','Pediatrician',7),
('Dr.Samer Sen Popuri','Neurologist',7);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Venkat Rao Abbineni','Pathology',8),
('Dr.Manish Dugar','Internal Medicine',8),
('Dr.Azhar Hussain Ansari','Urology',8),
('Dr.Srikar Krishna','Psychiartist',8),
('Dr.S Anant Kumar','General Surgery',8);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Prabakhar Sastry','Pathology',9),
('Dr.Ganesh Yadala','General Physician',9),
('Dr.Subhash Chander','Urology',9),
('Dr.LaskhmiKanth Reddy','Psychiartist',9),
('Dr.Srinivas Chakravarthy','General Surgery',9);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Dhananjaya K L','Surgeon',10),
('Dr.Surya Pavan Reddy','Dentist',10),
('Dr.L Sunandhini','Gynecologist',10),
('Dr.P Sampath','Psychiartist',10),
('Dr.Yakkala Suresh Babu','General Surgery',10);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Ashok Vardhan K','Pediatrician',11),
('Dr.Naveen Kumar PothiReddy','Dentist',11),
('Dr.Pramati Reddy','Gynecologist',11),
('Dr.Ravikiran Barigala','Psychiartist',11),
('Dr.Ganesh Mathan','General Surgery',11);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Gouraiah','Pediatrician',12),
('Dr.Somnath Rao','Dentist',12),
('Dr.Neelwati Soni','Gynecologist',12),
('Dr.Jayprakash Sai','Psychiartist',12),
('Dr.Trivikram','General Surgery',12);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Rajib Paul','Pediatrician',13),
('Dr.Gowri Shankar Bouripalli','Dentist',13),
('Dr.Smitha Reddy','Gynecologist',13),
('Dr.Sowmya Bondalapati','Orthopedician',13),
('Dr.Gopinath Bandari','General Surgery',13);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Krishna Mohan','Pediatrician',14),
('Dr.Rahul Gandhi Godisela','Dentist',14),
('Dr.Abhinandana','Gynecologist',14),
('Dr.M Srikanth Goud','Orthopedician',14),
('Dr.Vivel Belde','General Surgery',14);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.P Chandra Sekher','Pediatrician',15),
('Dr.Sameer Vankar','Dentist',15),
('Dr.Nilofer Ali','Gynecologist',15),
('Dr.Annam Sridhar','Orthopedician',15),
('Dr.Hemanth Kumar','General Surgery',15);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Ajitha Gotimukul','Pediatrician',16),
('Dr.Sahiti Priya','Dentist',16),
('Dr.Salma Sultana','Gynecologist',16),
('Dr.Srinivas Aditya','Orthopedician',16),
('Dr.Haarika Yalvarhi','General Surgery',16);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Srikar Reddy','Pediatrician',17),
('Dr.Kiran Macha','Dentist',17),
('Dr.Juveriya Fathima','Gynecologist',17),
('Dr.Markandeya Akurthi','Orthopedician',17),
('Dr.Mohd Ifthekar Mohiuddin','General Surgery',17);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.S Raghavender','Pediatrician',18),
('Dr.Ramanjaneyulu','Dentist',18),
('Dr.K Nagajyothi','Gynecologist',18),
('Dr.Swathi Prathipati','Orthopedician',18),
('Dr.Murali Mohan Reddy','General Surgery',18);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Vandana Rao','Pediatrician',19),
('Dr.Fayezah Syed','General Physician',19),
('Dr.Hemalatha M Reddy','Gynecologist',19),
('Dr.Sujeeth Kumar B','Orthopedician',19),
('Dr.G V Rajgopal','General Surgery',19);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Jukanti Nava Vikas','Pediatrician',20),
('Dr.Ranga Srikanth','General Physician',20),
('Dr.Susan Darla','Gynecologist',20),
('Dr.Pranav Ashwin Shah','Orthopedician',20),
('Dr.Mubasheer Syed','General Surgery',20);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Rup Goswami','Dermatologist',21),
('Dr.Srinivasulu','General Physician',21),
('Dr.Nimmagadda Viraja','Gynecologist',21),
('Dr.Cymantha Bandameedi','Cardiology',21),
('Dr.Dolla Raja Rajesh','Neurology',21);

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Karthik Meruva','General Practicioner',22),
('Dr.Aravind Reddy','General Physician',22),
('Dr.Saniya Simran','Gynecologist',22),
('Dr.Ramya Puligari','General Surgeon',22),
('Dr.Mohammad Asif Ahmad','Gastroenterology',22);

SELECT * FROM doctors LIMIT 100 OFFSET 0;

SELECT * FROM hospitals LIMIT 100 OFFSET 0;

SELECT * FROM doctors LIMIT 100 OFFSET 0;

INSERT INTO doctors(doctor_name,specialization,hospital_id) VALUES('Dr.Karthik Meruva','General Practicioner',19),
('Dr.Aravind Reddy','General Physician',19),
('Dr.Saniya Simran','Gynecologist',19),
('Dr.Ramya Puligari','General Surgeon',19),
('Dr.Mohammad Asif Ahmad','Gastroenterology',19);

SELECT * FROM doctors LIMIT 100 OFFSET 0;

DELETE FROM doctors WHERE doctor_id BETWEEN 125 AND 130;

SELECT * FROM doctors LIMIT 100 OFFSET 0;

ALTER TABLE patients DROP COLUMN doctor_id;

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Gopu Shiva','Back Pain',1),
('Bhanu Prakash','Fever',1),
('Adnan','Cough',1),
('Mohammed Ali','Headache',1),
('Mohammad Younus','Body Pains',1)
;

SELECT * FROM patients LIMIT 100 OFFSET 0;

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Ram Reddy','Kidney Pain',2),
('Trisha','Brain Tumer',2),
('Ashwin','Eye Infection',2),
('Mohammed Ibrahim','Diabetics',2),
('Rahul Rao','Pericarditius',2);

SELECT * FROM patients LIMIT 100 OFFSET 0;

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Krish','Kidney Transplatation',3),
('Mohan Reddy','Cancer',3),
('Anant Reddy','Asthma',3),
('Raji Reddy','Diabetics',3),
('Rahul Reddy Yerneni','Fever',3);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Janaki Reddy','Ashtma',4),
('Ramya Byraboina','Diabetics',4),
('Vishal Reddy','Dengue',4),
('Raj Rao','Malaria',4),
('Renu Reddy','MPox',4);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Nainika Reddy','Diabetics',5),
('Mounika Bareddy','Fever',5),
('Akhil Patel','Dengue',5),
('Boda Parmesh','Malaria',5),
('Naveen Reddy','MPox',5);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Manisha Ra0','Fever',6),
('Revanth Yerneni','Heart Stroke',6),
('Chandra','Dengue',6),
('Vamshi Kanth Reddy','Malaria',6),
('Yash Rangineni','MPox',6);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Rana Reddy','Fever',7),
('Revanth Bollampalli','Typhoid',7),
('Chandrasekher Reddy','Dengue',7),
('Vamshi Krishna','Malaria',7),
('Rani devi','Kidney Cancer',7);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Pandu Sharma','Liver Problem',8),
('Amara Adhya','Corona Virus',8),
('Pranav Sharma','Malaria',8),
('Rahul Ayyar','Typhoid',8),
('Pavagi','Brain Tumer',8);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Chatur Sardar','Malaria',9),
('Aradhya','Corona Virus',9),
('Dasra Panja','Fever',9),
('Megh Latha','Mpox',9),
('Abhi Bhave','Food Infection',9);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Sadhana Mahanti','Dengue',10),
('swamy','Corona Virus',10),
('Anusha Reddy','Fever',10),
('Hira Rajavadee','Stomach Pain',10),
('Vineeth Reddy','Food Infection',10);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Ragoba Punja','Diabetics',11),
('Naidu','Fever',11),
('Pavani Reddy','Malaria',11),
('Haritha Soni','Stomach Pain',11),
('Vineeth Rao','Food Infection',11);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Bhanu Reddy','Heart Stroke',12),
('Sai Krishna Reddy','Dengue',12),
('Nikhil Reddy','Typhoid',12),
('Mohammad Usama','Leg Pain',12),
('Sekher Reddy','Lukemia',12);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Utkarsh B','Dengue',13),
('Mohammad Abrar','Malaria',13),
('Sai Nikhil','Diabetics',13),
('Mohammad Asif','Joints Pain',13),
('Priyanka Reddy','Lung Cancer',13);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Sameer Mohammad','Typhoid',14),
('Mohammad Ansar','Diabetics',14),
('Sai Reddy','Malaria',14),
('Mohammad Asad','Stomach Pain',14),
('Anusha Sree Reddy','Kidney Stone',14);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Shiva Reddy','Diabetcics',15),
('Mohammad Bari Ahmad','Cancer',15),
('Akhil Reddy Byraboina','Heart Stroke',15),
('Mohammad Ayaan','Food Infection',15),
('Ananya Reddy','Kidney Stone',15);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Ganesh Reddy','Typhoid',16),
('Mohammad Ahmad Pasha','Kidney Stone',16),
('Naidu Swamy','Diabetics',16),
('Shaik Dawood','Lungs Infection',16),
('Anuhya Naidu','Kidney Swelling',16);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Ram Mohan Reddy','Heart Stroke',17),
('Mohammad Amir','Diabetics',17),
('Bolla Malliah Naidu','Cancer',17),
('Anand Rao','Fever',17),
('Nagi Needu Reddy','Kidney Transplatation',17);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Rajendra Reddy','Lung Cancer',18),
('Syed Sohail','Diabetics',18),
('Jaswant Reddy','Food Infection',18),
('Vijay Reddy','Dengue',18),
('Keerthi Reddy','Leptosporisis',18);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Ram Naidu Yerraboina','Typhoid',19),
('Arjun Naidu','Cancer',19),
('Preethi Reddy','Leptosporisis',19);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Kalyan Naidu','Malaria',20),
('Arun Reddy','Lung Cancer',20),
('Sekher Rao','Kidney Stone',20);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Saikumar','Diabetics',21),
('Phani Naidu','Brain Tumer',21),
('Vishnu Reddy','Dengue',21);

INSERT INTO patients(patient_name,disease,hospital_id) VALUES('Naveen Saini','Cancer',22),
('Mohammad Awaiz','Lungs Infection',22),
('Saikiran Naidu','Fever',22);

SELECT * FROM patients LIMIT 100 OFFSET 0;

ALTER TABLE appointments ADD COLUMN doctor_consultaion_fee INT;

SELECT * FROM hospitals LIMIT 100 OFFSET 0;

SELECT * FROM doctors LIMIT 100 OFFSET 0;

SELECT * FROM patients LIMIT 100 OFFSET 0;

SELECT * FROM hospitals LEFT JOIN doctors ON hospitals.hospital_id = doctors.hospital_id LIMIT 100 OFFSET 0;

SELECT doctors.doctor_name,hospitals.hospital_name FROM hospitals LEFT JOIN doctors ON hospitals.hospital_id = doctors.hospital_id LIMIT 100 OFFSET 0;

SELECT COUNT(doctors.doctor_name) FROM hospitals LEFT JOIN doctors ON hospitals.hospital_id = doctors.hospital_id LIMIT 100 OFFSET 0;

SELECT COUNT(doctors.doctor_name) FROM hospitals LEFT JOIN doctors ON hospitals.hospital_id = doctors.hospital_id GROUP BY hospitals.hospital_id LIMIT 100 OFFSET 0;

SELECT hospitals.hospital_name,COUNT(doctors.doctor_name) FROM hospitals LEFT JOIN doctors ON hospitals.hospital_id = doctors.hospital_id GROUP BY hospitals.hospital_id LIMIT 100 OFFSET 0;

SELECT hospitals.hospital_name,doctors.doctor_name FROM hospitals LEFT JOIN doctors ON hospitals.hospital_id = doctors.hospital_id GROUP BY hospitals.hospital_id,doctors.doctor_id LIMIT 100 OFFSET 0;

SELECT hospitals.hospital_name,doctors.doctor_name FROM hospitals LEFT JOIN doctors ON hospitals.hospital_id = doctors.hospital_id GROUP BY hospitals.hospital_id,doctors.doctor_id ORDER BY hospitals.hospital_name LIMIT 100 OFFSET 0;

INSERT INTO appointments(appointment_date,patient_id,doctor_id,hospital_id,doctor_consultaion_fee) VALUES('2023-8-24',107,17,8,917),
('2023-8-21',50,21,13,698),
('2023-8-6',90,19,3,987),
('2023-8-16',41,35,2,672),
('2023-8-29',4,44,20,529),
('2023-8-14',105,97,12,638),
('2023-8-16',60,40,4,593),
('2023-8-1',96,66,1,859),
('2023-8-12',64,19,3,702),
('2023-8-14',81,91,13,927),
('2023-8-3',77,54,13,622),
('2023-8-20',87,71,6,561),
('2023-8-29',76,27,14,985),
('2023-8-12',94,73,18,663),
('2023-8-1',50,28,22,667),
('2023-8-7',18,43,7,745),
('2023-8-9',88,89,20,556),
('2023-8-10',103,56,17,663),
('2023-8-4',88,82,2,554),
('2023-8-3',2,98,9,688),
('2023-8-29',106,45,8,946),
('2023-8-5',56,60,7,923),
('2023-8-1',9,12,19,602),
('2023-8-30',64,12,21,817),
('2023-8-22',6,48,1,754),
('2023-8-17',95,56,22,670),
('2023-8-1',79,92,3,908),
('2023-8-19',27,8,10,798),
('2023-8-28',40,3,20,868),
('2023-8-27',29,75,3,811),
('2023-8-27',87,72,14,891),
('2023-8-29',28,97,18,976),
('2023-8-19',9,85,21,611),
('2023-8-18',40,93,2,825),
('2023-8-3',56,116,17,571),
('2023-8-3',99,78,12,957),
('2023-8-4',21,13,22,968),
('2023-8-11',39,59,2,703),
('2023-8-31',51,102,6,694),
('2023-8-24',56,73,1,634);

SELECT * FROM appointments LIMIT 100 OFFSET 0;

SELECT * FROM hospitals LIMIT 100 OFFSET 0;

SELECT * FROM doctors LIMIT 100 OFFSET 0;

SELECT * FROM patients LIMIT 100 OFFSET 0;

SELECT * FROM appointments LIMIT 100 OFFSET 0;

SELECT hospitals.hospital_name AS HospitalName,COUNT(doctors.doctor_name) AS DoctorsCount FROM hospitals LEFT JOIN doctors ON hospitals.hospital_id = doctors.hospital_id GROUP BY hospitals.hospital_name LIMIT 100 OFFSET 0;

SELECT hospitals.hospital_name AS HospitalName,COUNT(doctors.doctor_name) AS DoctorsCount FROM hospitals LEFT JOIN doctors ON hospitals.hospital_id = doctors.hospital_id GROUP BY hospitals.hospital_name ORDER BY hospitals.hospital_name LIMIT 100 OFFSET 0;

SELECT hospitals.hospital_name AS HospitalName,doctors.doctor_name AS DoctorsName FROM hospitals LEFT JOIN doctors ON hospitals.hospital_id = doctors.hospital_id GROUP BY doctors.doctor_name,hospitals.hospital_name ORDER BY hospitals.hospital_name LIMIT 100 OFFSET 0;

SELECT * FROM appointments LEFT JOIN hospitals ON appointments.hospital_id = hospitals.hospital_id LIMIT 100 OFFSET 0;

SELECT hospitals.hospital_name AS hospitalName,doctors.doctor_name,patients.patient_name FROM appointments LEFT JOIN hospitals ON appointments.hospital_id = hospitals.hospital_id LEFT JOIN doctors ON doctors.hospital_id = hospitals.hospital_id LEFT JOIN patients ON doctors.hospital_id = patients.hospital_id LIMIT 100 OFFSET 0;

SELECT hospitals.hospital_name AS hospitalName,doctors.doctor_name,patients.patient_name,patients.disease FROM appointments LEFT JOIN hospitals ON appointments.hospital_id = hospitals.hospital_id LEFT JOIN doctors ON doctors.hospital_id = hospitals.hospital_id LEFT JOIN patients ON doctors.hospital_id = patients.hospital_id LIMIT 100 OFFSET 0;

SELECT hospitals.hospital_name AS hospitalName,doctors.doctor_name,patients.patient_name,patients.disease,appointments.doctor_consultaion_fee FROM appointments LEFT JOIN hospitals ON appointments.hospital_id = hospitals.hospital_id LEFT JOIN doctors ON doctors.hospital_id = hospitals.hospital_id LEFT JOIN patients ON doctors.hospital_id = patients.hospital_id LIMIT 100 OFFSET 0;
